<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mht.plugin.host.dao.AuthorityDao">
	
    <sql id="licenseColumns">
    	a.id,
    	a.plugin_code AS "pluginCode",
    	a.license,
    	a.enable,
		a.create_by AS "createBy.id",
		u.name AS "createBy.name",
		a.create_date
    </sql>
    
    <sql id="licenseJoins">
		left join mht_base.sys_user u on a.create_by=u.id 
    </sql>
	
	<!-- 分页查询用户信息 -->
	<select id="findList" resultType="LicenseInfo">
		SELECT
			<include refid="licenseColumns"/>
		FROM mht_plugin.plugin_license a
		<include refid="licenseJoins"/>
		<where>
			<if test="pluginCode != null and pluginCode != ''">
				AND a.plugin_code = #{pluginCode}
			</if>
			<if test="enable != null and enable != ''">
				AND a.enable = #{enable}
			</if>
			<!-- 数据范围过滤 -->
			${sqlMap.dsf}
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.create_date desc
			</otherwise>
		</choose>
	</select>
	
</mapper>