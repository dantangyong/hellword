<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.mht.define.portal.cms.dao.AppAuthUserDao">
    <sql id="columns">
    	a.app_name as 'app.appName',
    	a.id as 'app.id',
    	au.user_id as 'userId',
		au.app_id as 'appId',
		au.access_Auth as 'accessAuth'
    </sql>
    
	<select id="findListByUserId" resultType="AppAuthUser">
        SELECT 
            <include refid="columns"/>
        from mht_portal.cms_front_app a
        LEFT JOIN mht_portal.app_auth_user au on a.id = au.app_id
		<if test="userId != null and userId != ''">
        	AND au.user_id=#{userId}
        </if>
        LEFT JOIN mht_base.sys_user su on au.user_id = su.id
        WHERE a.del_flag='0'
        ORDER BY a.sort ASC
    </select>
	
	
	<insert id="insert">
		INSERT INTO mht_portal.app_auth_user (
	        user_id,
	        access_auth,
	        app_id
		) VALUES (
            #{userId},
            #{accessAuth},
			#{appId}
		)
	</insert>
		
	<delete id="deleteByUserId">
		delete from mht_portal.app_auth_user where user_id = #{userId}
	</delete>
	
</mapper>